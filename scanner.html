<!DOCTYPE html>
<html>
<head>
    <title>QR Scanner</title>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <style>
        #reader {
            width: 300px;
            margin: 20px auto;
        }
        h2, p {
            text-align: center;
        }
    </style>
</head>
<body>

<h2>QR Attendance Scanner</h2>
<p id="result">Scan a QR Code...</p>

<div id="reader"></div>

<script>
    function onScanSuccess(decodedText, decodedResult) {
        document.getElementById('result').innerText = "QR Detected: " + decodedText;

        // AJAX to send QR to server
        fetch('mark_attendance.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: 'qr=' + encodeURIComponent(decodedText)
        })
        .then(response => response.text())
        .then(data => {
            alert(data);  // Show success or error from server
        });
        
        html5QrcodeScanner.clear(); // stop scanning after success
    }

    const html5QrcodeScanner = new Html5QrcodeScanner("reader", { fps: 10, qrbox: 250 });
    html5QrcodeScanner.render(onScanSuccess);
</script>

</body>
</html>